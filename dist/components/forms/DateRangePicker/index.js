import{useRef as j,useState as y,useEffect as z}from"react";import{format as I}from"date-fns";import x from"date-fns/locale/es";/* empty css                                                *//* empty css                                                       */import{IconCalendar as O}from"../../../icons/IconCalendar/index.js";import{DateRange as T}from"react-date-range";import"../../Typography/TextBuilder/index.js";import{jsxs as s,jsx as n}from"react/jsx-runtime";import{Text as H}from"../../Typography/Text/index.js";import{Button as L}from"../../Button/index.js";import{Container as $,ContainerDate as B,ContainerDatePicker as V,FooterDatePicker as q,TimeInputsContainer as J}from"./styles.js";const ne=({onGetFilters:g,initState:M,showIconCalendar:Y=!0,showTimeInputs:w=!1,direction:A="horizontal",dateFormatDisplayed:C="detailed",initWithToday:k=!1,...E})=>{const c=j(null),[a,F]=y({from:"00:00",to:"23:59"}),[f,u]=y(!1),[r,h]=y(M?[M]:[{startDate:k?new Date(Date.now()):void 0,endDate:k?new Date(Date.now()):void 0,key:"selection"}]),D=t=>{var e,o;if((r==null?void 0:r.length)>0&&((e=r[0])==null?void 0:e.startDate)&&((o=r[0])==null?void 0:o.endDate)){const{startDate:i,endDate:m}=r[0],p=t==="from"?i:m;let l="";return w?l=C==="simple"?"dd/MM/yyyy HH:mm":"dd 'de' MMMM 'del' YYY hh:mm aaaaa'm'":l=C==="simple"?"dd/MM/yyyy":"dd 'de' MMMM 'del' YYY",I(p,l,{locale:x})}},S=(t,e)=>{F(o=>({...o,[e]:t}))},N=t=>{var e,o,i,m;if(t)g(null),h([{startDate:void 0,endDate:void 0,key:"selection"}]);else{const[p,l]=(e=a==null?void 0:a.from)==null?void 0:e.split(":"),[P,R]=(o=a==null?void 0:a.to)==null?void 0:o.split(":");let d,v;if((i=r[0])!=null&&i.startDate&&(d=new Date(r[0].startDate),d.setHours(Number(p||0),Number(l||0),0)),(m=r[0])!=null&&m.endDate&&(v=new Date(r[0].endDate),v.setHours(Number(P||23),Number(R||59),59)),d&&d){const b={...r[0],startDate:d,endDate:v};h([b]),g(b)}}u(!1)};return z(()=>{const t=e=>{var o;f&&c.current&&!((o=c.current)!=null&&o.contains(e.target))&&u(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[f]),s($,{ref:c,children:[s(B,{onClick:()=>u(!0),children:[Y&&n(O,{}),D("from")?n("p",{children:`${D("from")} - ${D("to")}`}):n("p",{style:{fontSize:"0.875rem"},children:"Seleccione una fecha"})]}),f&&s(V,{children:[n(T,{onChange:t=>{var o,i;const e=Object.values(t);!Array.isArray(e)||(e==null?void 0:e.length)<1||h([{...r[0],startDate:(o=e[0])==null?void 0:o.startDate,endDate:(i=e[0])==null?void 0:i.endDate}])},showSelectionPreview:!0,moveRangeOnFirstSelection:!1,months:1,ranges:r,direction:A,locale:x,...E}),s(q,{children:[w&&s(J,{children:[s("div",{children:[n(H,{as:"label",htmlFor:"hour-from",children:"desde:"}),n("input",{type:"time",id:"hour-from",value:a.from,onChange:t=>S(t.target.value,"from")})]}),s("div",{children:[n(H,{as:"label",htmlFor:"hour-to",children:"hasta:"}),n("input",{type:"time",id:"hour-to",defaultValue:a.to,onChange:t=>S(t.target.value,"to")})]})]}),n(L,{size:"xs",py:"5px",onClick:()=>N(!1),children:"Aplicar"})]})]})]})};export{ne as DateRangePicker};
